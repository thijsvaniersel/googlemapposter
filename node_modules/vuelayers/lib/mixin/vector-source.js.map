{"version":3,"file":"vector-source.js","sources":["src/mixin/vector-source.js"],"sourcesContent":["import debounce from 'debounce-promise'\nimport mergeDescriptors from '../util/multi-merge-descriptors'\nimport { makeWatchers } from '../util/vue-helpers'\nimport featuresContainer from './features-container'\nimport projTransforms from './proj-transforms'\nimport source from './source'\n\nexport default {\n  mixins: [source, featuresContainer, projTransforms],\n  props: {\n    useSpatialIndex: {\n      type: Boolean,\n      default: true,\n    },\n  },\n  methods: {\n    /**\n     * @return {void}\n     */\n    clear () {\n      this::featuresContainer.methods.clearFeatures()\n    },\n    /**\n     * @return {Object}\n     * @protected\n     */\n    getServices () {\n      return mergeDescriptors(\n        this::source.methods.getServices(),\n        this::featuresContainer.methods.getServices(),\n      )\n    },\n    /**\n     * @return {Promise}\n     * @protected\n     */\n    init () {\n      return this::source.methods.init()\n    },\n    /**\n     * @return {void|Promise<void>}\n     * @protected\n     */\n    deinit () {\n      return this::source.methods.deinit()\n    },\n    /**\n     * @return {void}\n     * @protected\n     */\n    mount () {\n      return this::source.methods.mount()\n    },\n    /**\n     * @return {void}\n     * @protected\n     */\n    unmount () {\n      return this::source.methods.unmount()\n    },\n    /**\n     * @return {void}\n     * @protected\n     */\n    subscribeAll () {\n      this::source.methods.subscribeAll()\n    },\n    /**\n     * @param feature\n     * @return {ReadonlyArray<any>}\n     * @protected\n     */\n    writeFeatureInDataProj (feature) {\n      return this::projTransforms.methods.writeFeatureInDataProj(feature)\n    },\n    /**\n     * @param feature\n     * @return {ReadonlyArray<any>}\n     * @protected\n     */\n    writeGeometryInViewProj (feature) {\n      return this::projTransforms.methods.writeFeatureInViewProj(feature)\n    },\n  },\n  watch: {\n    featuresDataProj: {\n      deep: true,\n      handler: debounce(function (features) {\n        this.$emit('update:features', features.slice())\n      }, 1000 / 60),\n    },\n    ...makeWatchers([\n      'useSpatialIndex',\n    ], () => function () {\n      return this.scheduleRecreate()\n    }),\n  },\n  stubVNode: {\n    empty: false,\n    attrs () {\n      return {\n        id: this.vmId,\n        class: this.cmpName,\n      }\n    },\n  },\n}\n"],"names":["mixins","source","featuresContainer","projTransforms","props","useSpatialIndex","type","Boolean","default","methods","clear","clearFeatures","getServices","mergeDescriptors","init","deinit","mount","unmount","subscribeAll","writeFeatureInDataProj","feature","writeGeometryInViewProj","writeFeatureInViewProj","watch","featuresDataProj","deep","handler","debounce","features","$emit","makeWatchers","scheduleRecreate","stubVNode","empty","attrs","id","vmId","class","cmpName"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOA,mBAAe;EACbA,MAAM,EAAE,CAACC,MAAD,EAASC,iBAAT,EAA4BC,cAA5B,CADK;EAEbC,KAAK,EAAE;IACLC,eAAe,EAAE;MACfC,IAAI,EAAEC,OADS;MAEfC,OAAO,EAAE;;GALA;EAQbC,OAAO,EAAE;;;;IAIPC,KAJO,mBAIE;MACDR,iBAAiB,CAACO,OAAlB,CAA0BE,aAAhC;KALK;;;;;;IAWPC,WAXO,yBAWQ;aACNC,gBAAgB,CACfZ,MAAM,CAACQ,OAAP,CAAeG,WAArB,WADqB,EAEfV,iBAAiB,CAACO,OAAlB,CAA0BG,WAAhC,WAFqB,CAAvB;KAZK;;;;;;IAqBPE,IArBO,kBAqBC;aACOb,MAAM,CAACQ,OAAP,CAAeK,IAArB,WAAP;KAtBK;;;;;;IA4BPC,MA5BO,oBA4BG;aACKd,MAAM,CAACQ,OAAP,CAAeM,MAArB,WAAP;KA7BK;;;;;;IAmCPC,KAnCO,mBAmCE;aACMf,MAAM,CAACQ,OAAP,CAAeO,KAArB,WAAP;KApCK;;;;;;IA0CPC,OA1CO,qBA0CI;aACIhB,MAAM,CAACQ,OAAP,CAAeQ,OAArB,WAAP;KA3CK;;;;;;IAiDPC,YAjDO,0BAiDS;MACRjB,MAAM,CAACQ,OAAP,CAAeS,YAArB;KAlDK;;;;;;;IAyDPC,sBAzDO,kCAyDiBC,OAzDjB,EAyD0B;aAClBjB,cAAc,CAACM,OAAf,CAAuBU,sBAA7B,YAAoDC,OAApD,CAAP;KA1DK;;;;;;;IAiEPC,uBAjEO,mCAiEkBD,OAjElB,EAiE2B;aACnBjB,cAAc,CAACM,OAAf,CAAuBa,sBAA7B,YAAoDF,OAApD,CAAP;;GA1ES;EA6EbG,KAAK;IACHC,gBAAgB,EAAE;MAChBC,IAAI,EAAE,IADU;MAEhBC,OAAO,EAAEC,QAAQ,CAAC,UAAUC,QAAV,EAAoB;aAC/BC,KAAL,CAAW,iBAAX,EAA8B,uBAAAD,QAAQ,MAAR,CAAAA,QAAQ,CAAtC;OADe,EAEd,OAAO,EAFO;;KAIhBE,YAAY,CAAC,CACd,iBADc,CAAD,EAEZ;WAAM,YAAY;aACZ,KAAKC,gBAAL,EAAP;KADC;GAFY,CAPZ,CA7EQ;EA0FbC,SAAS,EAAE;IACTC,KAAK,EAAE,KADE;IAETC,KAFS,mBAEA;aACA;QACLC,EAAE,EAAE,KAAKC,IADJ;QAELC,KAAK,EAAE,KAAKC;OAFd;;;CA7FN;;;;"}