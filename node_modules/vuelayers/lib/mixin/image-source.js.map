{"version":3,"file":"image-source.js","sources":["src/mixin/image-source.js"],"sourcesContent":["import { EPSG_3857 } from '../ol-ext'\nimport { observableFromOlEvent } from '../rx-ext'\nimport { hasSource } from '../util/assert'\nimport { makeWatchers } from '../util/vue-helpers'\nimport source from './source'\n\nexport default {\n  mixins: [source],\n  props: {\n    crossOrigin: String,\n    projection: {\n      type: String,\n      default: EPSG_3857,\n    },\n  },\n  methods: {\n    /**\n     * @return {Promise}\n     * @protected\n     */\n    init () {\n      return this::source.methods.init()\n    },\n    /**\n     * @return {void|Promise<void>}\n     * @protected\n     */\n    deinit () {\n      return this::source.methods.deinit()\n    },\n    /**\n     * @return {void}\n     * @protected\n     */\n    mount () {\n      this::source.methods.mount()\n    },\n    /**\n     * @return {void}\n     * @protected\n     */\n    unmount () {\n      this::source.methods.unmount()\n    },\n    subscribeAll () {\n      this::source.methods.subscribeAll()\n      this::subscribeToSourceEvents()\n    },\n  },\n  watch: {\n    ...makeWatchers([\n      'crossOrigin',\n    ], () => function () {\n      this.scheduleRecreate()\n    }),\n  },\n}\n\nfunction subscribeToSourceEvents () {\n  hasSource(this)\n\n  const events = observableFromOlEvent(this.$source, [\n    'imageloadend',\n    'imageloaderror',\n    'imageloadstart',\n  ])\n\n  this.subscribeTo(events, evt => {\n    this.$emit(evt.type, evt)\n  })\n}\n"],"names":["mixins","source","props","crossOrigin","String","projection","type","default","EPSG_3857","methods","init","deinit","mount","unmount","subscribeAll","subscribeToSourceEvents","watch","makeWatchers","scheduleRecreate","hasSource","events","observableFromOlEvent","$source","subscribeTo","evt","$emit"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAMA,kBAAe;EACbA,MAAM,EAAE,CAACC,MAAD,CADK;EAEbC,KAAK,EAAE;IACLC,WAAW,EAAEC,MADR;IAELC,UAAU,EAAE;MACVC,IAAI,EAAEF,MADI;MAEVG,OAAO,EAAEC;;GANA;EASbC,OAAO,EAAE;;;;;IAKPC,IALO,kBAKC;aACOT,MAAM,CAACQ,OAAP,CAAeC,IAArB,WAAP;KANK;;;;;;IAYPC,MAZO,oBAYG;aACKV,MAAM,CAACQ,OAAP,CAAeE,MAArB,WAAP;KAbK;;;;;;IAmBPC,KAnBO,mBAmBE;MACDX,MAAM,CAACQ,OAAP,CAAeG,KAArB;KApBK;;;;;;IA0BPC,OA1BO,qBA0BI;MACHZ,MAAM,CAACQ,OAAP,CAAeI,OAArB;KA3BK;IA6BPC,YA7BO,0BA6BS;MACRb,MAAM,CAACQ,OAAP,CAAeK,YAArB;MACMC,uBAAN;;GAxCS;EA2CbC,KAAK,oBACAC,YAAY,CAAC,CACd,aADc,CAAD,EAEZ;WAAM,YAAY;WACdC,gBAAL;KADC;GAFY,CADZ;CA3CP;;AAoDA,SAASH,uBAAT,GAAoC;;;EAClCI,SAAS,CAAC,IAAD,CAAT;MAEMC,MAAM,GAAGC,qBAAqB,CAAC,KAAKC,OAAN,EAAe,CACjD,cADiD,EAEjD,gBAFiD,EAGjD,gBAHiD,CAAf,CAApC;OAMKC,WAAL,CAAiBH,MAAjB,EAAyB,UAAAI,GAAG,EAAI;IAC9B,KAAI,CAACC,KAAL,CAAWD,GAAG,CAAClB,IAAf,EAAqBkB,GAArB;GADF;;;;;"}