{"version":3,"file":"from-ol-change-event.js","sources":["src/rx-ext/from-ol-change-event.js"],"sourcesContent":["import { merge as mergeObs } from 'rxjs/observable'\nimport { distinctUntilChanged, map as mapObs, debounceTime } from 'rxjs/operators'\nimport { isEqual, isFunction } from '../util/minilo'\nimport fromOlEvent from './from-ol-event'\n\n/**\n * Creates Observable from OpenLayers change:* event\n * @param {module:ol/Observable~Observable} target\n * @param {string|string[]} [prop]\n * @param {boolean|function(a, b):boolean|undefined} [distinct] Distinct values by isEqual fn or by custom comparator\n * @param {number|undefined} [debounce] Debounce values by passed amount of ms.\n * @param {function|undefined} [selector] Custom selector\n * @return {Observable<{prop: string, value: *}>}\n */\nexport default function fromOlChangeEvent (target, prop, distinct, debounce, selector) {\n  if (Array.isArray(prop)) {\n    return mergeObs(...prop.map(p => fromOlChangeEvent(target, p)))\n  }\n\n  selector = selector || ((target, prop) => target.get(prop))\n  let event = `change:${prop}`\n  let observable = fromOlEvent(target, event, () => selector(target, prop))\n  let operations = []\n\n  if (debounce != null) {\n    operations.push(debounceTime(debounce))\n  }\n  if (distinct) {\n    isFunction(distinct) || (distinct = isEqual)\n    operations.push(distinctUntilChanged(distinct))\n  }\n\n  operations.push(mapObs(value => ({ prop, value })))\n\n  return observable.pipe(...operations)\n}\n"],"names":["fromOlChangeEvent","target","prop","distinct","debounce","selector","mergeObs","p","get","event","observable","fromOlEvent","operations","push","debounceTime","isFunction","isEqual","distinctUntilChanged","mapObs","value","pipe"],"mappings":";;;;;;;;;;;;;;;;;;;;AAKA;;;;;;;;;;AASA,AAAe,SAASA,iBAAT,CAA4BC,MAA5B,EAAoCC,IAApC,EAA0CC,QAA1C,EAAoDC,QAApD,EAA8DC,QAA9D,EAAwE;MACjF,eAAcH,IAAd,CAAJ,EAAyB;WAChBI,KAAQ,MAAR,4BAAY,qBAAAJ,IAAI,MAAJ,CAAAA,IAAI,EAAK,UAAAK,CAAC;aAAIP,iBAAiB,CAACC,MAAD,EAASM,CAAT,CAArB;KAAN,CAAhB,EAAP;;;EAGFF,QAAQ,GAAGA,QAAQ,IAAK,UAACJ,MAAD,EAASC,IAAT;WAAkBD,MAAM,CAACO,GAAP,CAAWN,IAAX,CAAlB;GAAxB;;MACIO,KAAK,oBAAaP,IAAb,CAAT;MACIQ,UAAU,GAAGC,WAAW,CAACV,MAAD,EAASQ,KAAT,EAAgB;WAAMJ,QAAQ,CAACJ,MAAD,EAASC,IAAT,CAAd;GAAhB,CAA5B;MACIU,UAAU,GAAG,EAAjB;;MAEIR,QAAQ,IAAI,IAAhB,EAAsB;IACpBQ,UAAU,CAACC,IAAX,CAAgBC,YAAY,CAACV,QAAD,CAA5B;;;MAEED,QAAJ,EAAc;IACZY,UAAU,CAACZ,QAAD,CAAV,KAAyBA,QAAQ,GAAGa,OAApC;IACAJ,UAAU,CAACC,IAAX,CAAgBI,oBAAoB,CAACd,QAAD,CAApC;;;EAGFS,UAAU,CAACC,IAAX,CAAgBK,GAAM,CAAC,UAAAC,KAAK;WAAK;MAAEjB,IAAI,EAAJA,IAAF;MAAQiB,KAAK,EAALA;KAAb;GAAN,CAAtB;SAEOT,UAAU,CAACU,IAAX,OAAAV,UAAU,EAASE,UAAT,CAAjB;;;;;"}