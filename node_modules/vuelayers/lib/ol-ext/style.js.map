{"version":3,"file":"style.js","sources":["src/ol-ext/style.js"],"sourcesContent":["import Circle from 'ol/style/Circle'\nimport Fill from 'ol/style/Fill'\nimport Icon from 'ol/style/Icon'\nimport ImageStyle from 'ol/style/Image'\nimport RegularShape from 'ol/style/RegularShape'\nimport Stroke from 'ol/style/Stroke'\nimport Style from 'ol/style/Style'\nimport Text from 'ol/style/Text'\nimport parseColor from 'parse-color'\nimport uuid from 'uuid/v4'\nimport Vue from 'vue'\nimport { isFunction, isNumeric, isNumber, lowerFirst, pick, reduce, upperFirst } from '../util/minilo'\nimport { GEOMETRY_TYPE } from './consts'\nimport * as geomHelper from './geom'\n\nexport function getStyleId (style) {\n  if (\n    style instanceof Vue ||\n    style instanceof Style ||\n    style instanceof ImageStyle ||\n    style instanceof Text ||\n    style instanceof Stroke ||\n    style instanceof Fill ||\n    style instanceof Function\n  ) {\n    return style.id\n  }\n\n  throw new Error('Illegal style argument')\n}\n\nexport function setStyleId (style, styleId) {\n  if (\n    style instanceof Vue ||\n    style instanceof Style ||\n    style instanceof ImageStyle ||\n    style instanceof Text ||\n    style instanceof Stroke ||\n    style instanceof Fill ||\n    style instanceof Function\n  ) {\n    style.id = styleId\n\n    return style\n  }\n\n  throw new Error('Illegal style argument')\n}\n\nexport function initializeStyle (style, defaultStyleId) {\n  if (getStyleId(style) == null) {\n    setStyleId(style, defaultStyleId || uuid())\n  }\n\n  return style\n}\n\n/**\n * @return {VlStyle[]}\n */\nexport function defaultStyle () {\n  return [\n    {\n      fillColor: [255, 255, 255, 0.4],\n      strokeColor: '#3399cc',\n      strokeWidth: 1.25,\n      imageRadius: 5,\n    },\n  ]\n}\n\n/**\n * @return {Object<GEOMETRY_TYPE, VlStyle[]>}\n */\nexport function defaultEditStyle () {\n  /** @type {Object<GEOMETRY_TYPE, VlStyle[]>} */\n  let styles = {}\n  let white = [255, 255, 255, 1]\n  let blue = [0, 153, 255, 1]\n  let width = 3\n\n  styles[GEOMETRY_TYPE.LINE_STRING] = [\n    {\n      strokeColor: white,\n      strokeWidth: width + 2,\n    }, {\n      strokeColor: blue,\n      strokeWidth: width,\n    },\n  ]\n  styles[GEOMETRY_TYPE.MULTI_LINE_STRING] = styles[GEOMETRY_TYPE.LINE_STRING]\n\n  styles[GEOMETRY_TYPE.POLYGON] = [\n    {\n      fillColor: [255, 255, 255, 0.5],\n    },\n  ].concat(styles[GEOMETRY_TYPE.LINE_STRING])\n  styles[GEOMETRY_TYPE.MULTI_POLYGON] = styles[GEOMETRY_TYPE.POLYGON]\n\n  styles[GEOMETRY_TYPE.CIRCLE] = styles[GEOMETRY_TYPE.POLYGON].concat(styles[GEOMETRY_TYPE.LINE_STRING])\n\n  styles[GEOMETRY_TYPE.POINT] = [\n    {\n      imageRadius: width * 2,\n      fillColor: blue,\n      strokeColor: white,\n      strokeWidth: width / 2,\n      zIndex: Infinity,\n    },\n  ]\n  styles[GEOMETRY_TYPE.MULTI_POINT] = styles[GEOMETRY_TYPE.POINT]\n\n  styles[GEOMETRY_TYPE.GEOMETRY_COLLECTION] = styles[GEOMETRY_TYPE.POLYGON].concat(\n    styles[GEOMETRY_TYPE.LINE_STRING],\n    styles[GEOMETRY_TYPE.POINT],\n  )\n\n  return styles\n}\n\nconst isEmpty = x => {\n  if (x == null) return true\n  if (typeof x === 'number') return false\n\n  return ((typeof x === 'string' || Array.isArray(x)) && !x.length) || !Object.keys(x).length\n}\n\n/**\n * @param {VlStyle} vlStyle\n * @return {Style|undefined}\n */\nexport function createStyle (vlStyle) {\n  if (isEmpty(vlStyle)) return\n\n  const olStyle = {\n    text: createTextStyle(vlStyle),\n    fill: createFillStyle(vlStyle),\n    stroke: createStrokeStyle(vlStyle),\n    image: createImageStyle(vlStyle),\n    geometry: createGeomStyle(vlStyle),\n    zIndex: vlStyle.zIndex,\n    renderer: vlStyle.renderer,\n  }\n\n  if (!isEmpty(olStyle)) {\n    return new Style(olStyle)\n  }\n}\n\nconst addPrefix = prefix => str => prefix + (prefix ? upperFirst(str) : str)\n\n/**\n * @param {*} color\n * @returns {*}\n */\nexport function normalizeColor (color) {\n  let c = color\n\n  if (typeof color === 'string') {\n    c = parseColor(color).rgba\n  }\n\n  return c\n}\n\n/**\n * @param {VlStyle} vlStyle\n * @param {string} [prefix]\n * @returns {Fill|undefined}\n */\nexport function createFillStyle (vlStyle, prefix = '') {\n  const prefixKey = addPrefix(prefix)\n  const keys = ['fillColor'].map(prefixKey)\n  const compiledKey = prefixKey('fill')\n\n  // check on already compiled style existence\n  if (vlStyle[compiledKey] instanceof Fill) return vlStyle[compiledKey]\n\n  const fillStyle = reduce(vlStyle, (style, value, name) => {\n    if (keys.includes(name) === false) {\n      return style\n    }\n    name = lowerFirst(name.replace(new RegExp(prefixKey('fill')), ''))\n    if (name === 'color') {\n      value = normalizeColor(value)\n    }\n    style[name] = value\n    return style\n  }, {})\n\n  if (!isEmpty(fillStyle)) {\n    return new Fill(fillStyle)\n  }\n}\n\n/**\n * @param {VlStyle} vlStyle\n * @param {string} [prefix]\n * @returns {Stroke|undefined}\n */\nexport function createStrokeStyle (vlStyle, prefix = '') {\n  const prefixKey = addPrefix(prefix)\n  const keys = [\n    'strokeColor',\n    'strokeWidth',\n    'strokeMiterLimit',\n    'strokeCap',\n    'strokeJoin',\n    'strokeDash',\n    'strokeDashOffset',\n  ].map(prefixKey)\n  const compiledKey = prefixKey('stroke')\n\n  if (vlStyle[compiledKey] instanceof Stroke) return vlStyle[compiledKey]\n\n  const strokeStyle = reduce(vlStyle, (style, value, name) => {\n    if (keys.includes(name) === false) {\n      return style\n    }\n    switch (name) {\n      case prefixKey('strokeColor'):\n      case prefixKey('strokeWidth'):\n      case prefixKey('strokeMiterLimit'):\n        name = lowerFirst(name.replace(new RegExp(prefixKey('stroke')), ''))\n        break\n      case prefixKey('strokeCap'):\n      case prefixKey('strokeJoin'):\n      case prefixKey('strokeDash'):\n      case prefixKey('strokeDashOffset'):\n        name = 'line' + name.replace(new RegExp(prefixKey('stroke')), '')\n        break\n    }\n    if (name === 'color') {\n      value = normalizeColor(value)\n    }\n    style[name] = value\n    return style\n  }, {})\n\n  if (!isEmpty(strokeStyle)) {\n    return new Stroke(strokeStyle)\n  }\n}\n\n/**\n * @param {VlStyle} vlStyle\n * @returns {Image|undefined}\n * @todo split to separate circle, regShape, Icon\n */\nexport function createImageStyle (vlStyle) {\n  if (\n    isEmpty(vlStyle.imageSrc) &&\n    isEmpty(vlStyle.image) &&\n    isEmpty(vlStyle.imagePoints) &&\n    !isNumeric(vlStyle.imageRadius)\n  ) {\n    return\n  }\n\n  if (vlStyle.image instanceof ImageStyle) return vlStyle.image\n\n  let imageStyle, Ctor\n\n  if (!isEmpty(vlStyle.imageSrc) || !isEmpty(vlStyle.image)) {\n    // icon construction\n    Ctor = Icon\n    // then create Icon options\n    imageStyle = {\n      ...vlStyle,\n      anchor: vlStyle.imageAnchor,\n      anchorOrigin: vlStyle.imageAnchorOrigin,\n      color: vlStyle.imageColor,\n      offset: vlStyle.imageOffset,\n      offsetOrigin: vlStyle.imageOffsetOrigin,\n      opacity: vlStyle.imageOpacity,\n      scale: vlStyle.imageScale,\n      rotation: vlStyle.imageRotation,\n      size: vlStyle.imageSize,\n      img: vlStyle.image,\n      imgSize: vlStyle.imageImgSize,\n      src: vlStyle.imageSrc,\n      crossOrigin: vlStyle.imageCrossOrigin,\n    }\n  } else if (vlStyle.imagePoints != null) {\n    // regular shape construction\n    Ctor = RegularShape\n    // create RegularShape options\n    imageStyle = {\n      ...vlStyle,\n      points: vlStyle.imagePoints,\n      radius: vlStyle.imageRadius,\n      radius1: vlStyle.imageRadius1,\n      radius2: vlStyle.imageRadius2,\n      angle: vlStyle.imageAngle,\n      rotation: vlStyle.imageRotation,\n    }\n  } else {\n    // circle construction\n    Ctor = Circle\n    // create Circle options\n    imageStyle = {\n      ...vlStyle,\n      radius: vlStyle.imageRadius,\n    }\n  }\n\n  imageStyle = {\n    ...imageStyle,\n    fill: createFillStyle(vlStyle, 'image') || createFillStyle(vlStyle),\n    stroke: createStrokeStyle(vlStyle, 'image') || createStrokeStyle(vlStyle),\n    snapToPixel: true,\n  }\n\n  if (!isEmpty(imageStyle)) {\n    return new Ctor(imageStyle)\n  }\n}\n\n/**\n * @param {VlStyle} vlStyle\n * @returns {Text|undefined}\n */\nexport function createTextStyle (vlStyle) {\n  if (vlStyle.text == null) return\n  if (vlStyle.text instanceof Text) return vlStyle.text\n\n  const textStyle = {\n    text: vlStyle.text,\n  }\n\n  let fontSize = '10px'\n  if (vlStyle.textFontSize) {\n    fontSize = isNumber(vlStyle.textFontSize) ? vlStyle.textFontSize + 'px' : vlStyle.textFontSize\n  }\n  let fontName = vlStyle.textFont || 'sans-serif'\n  const font = [vlStyle.textFontWeight, fontSize, fontName].filter(x => !!x).join(' ')\n\n  Object.assign(\n    textStyle,\n    pick(vlStyle, ['textAlign', 'textBaseline']),\n    {\n      font,\n      fill: createFillStyle(vlStyle, 'text') || createFillStyle(vlStyle),\n      stroke: createStrokeStyle(vlStyle, 'text') || createStrokeStyle(vlStyle),\n      scale: vlStyle.textScale,\n      rotation: vlStyle.textRotation,\n      offsetX: vlStyle.textOffsetX,\n      offsetY: vlStyle.textOffsetY,\n      rotateWithView: vlStyle.textRotateWithView,\n      padding: vlStyle.textPadding,\n      maxAngle: vlStyle.textMaxAngle,\n      overflow: vlStyle.textOverflow,\n      placement: vlStyle.textPlacement,\n      backgroundFill: createFillStyle(vlStyle, 'textBackground'),\n      backgroundStroke: createStrokeStyle(vlStyle, 'textBackground'),\n    },\n  )\n\n  if (!isEmpty(textStyle)) {\n    return new Text(textStyle)\n  }\n}\n\n/**\n * @param {VlStyle} vlStyle\n * @return {Geometry|function|undefined}\n */\nexport function createGeomStyle (vlStyle) {\n  if (isFunction(vlStyle.geom)) {\n    return function __styleGeomFunc (feature) {\n      return vlStyle.geom(feature, geomHelper)\n    }\n  }\n\n  return vlStyle.geom\n}\n\n/**\n * @typedef {Style|Image|Fill|Stroke|Text|StyleFunction} OlStyle\n */\n\n/**\n * @typedef {Object} VlStyle\n *\n * Shared\n * @property {string|number[]|undefined} fillColor\n * @property {string|number[]|undefined} strokeColor\n * @property {number|undefined} strokeWidth\n * @property {number|undefined} strokeMiterLimit\n * @property {number[]|undefined} strokeDash\n * @property {number[]|undefined} strokeDashOffset\n * @property {string|undefined} strokeCap\n * @property {string|undefined} strokeJoin\n * @property {number|undefined} zIndex\n * @property {Fill|undefined} fill\n * @property {Stroke|undefined} stroke\n * @property {RenderFunction|undefined} renderer\n *\n * Text only\n * @property {string|Text|undefined} text\n * @property {string|undefined} textFont\n * @property {number|string|undefined} textFontSize\n * @property {string|undefined} textFontWeight\n * @property {string|number[]|undefined} textFillColor\n * @property {string|number[]|undefined} textStrokeColor\n * @property {number|undefined} textStrokeWidth\n * @property {number[]|undefined} textStrokeDash\n * @property {string|undefined} textStrokeCap\n * @property {string|undefined} textStrokeJoin\n * @property {number|undefined} textScale\n * @property {string|undefined} textAlign\n * @property {number|undefined} textRotation\n * @property {number|undefined} textOffsetX\n * @property {number|undefined} textOffsetY\n * @property {Stroke|undefined} textStroke\n * @property {Fill|undefined} textFill\n * @property {boolean|undefined} textRotateWithView\n * @property {number[]|undefined} textPadding\n * @property {number|undefined} textMaxAngle\n * @property {boolean|undefined} textOverflow\n * @property {string|undefined} textPlacement\n * @property {string|undefined} textBaseline\n * @property {Fill|undefined} textBackgroundFillColor\n * @property {Stroke|undefined} textBackgroundStrokeColor\n * @property {Stroke|undefined} textBackgroundStrokeWidth\n * @property {Stroke|undefined} textBackgroundStrokeDash\n * @property {Stroke|undefined} textBackgroundStrokeCap\n * @property {Stroke|undefined} textBackgroundStrokeJoin\n *\n * Image only\n * @property {Image|undefined} image\n * @property {string|undefined} imageSrc\n * @property {number[]|undefined} imageSize\n * @property {number[]|undefined} imageImgSize\n * @property {number|undefined} imageOffset\n * @property {number[]|undefined} imageAnchor\n * @property {number|undefined} imageScale\n * @property {number|undefined} imageRotation\n * @property {number|undefined} imageRadius\n * @property {number|undefined} imageRadius1\n * @property {number|undefined} imageRadius2\n * @property {number|undefined} imagePoints\n * @property {number|undefined} imageAngle\n * @property {number|undefined} imageOpacity\n * @property {string|number[]|undefined} imageFillColor\n * @property {string|number[]|undefined} imageStrokeColor\n * @property {number|undefined} imageStrokeWidth\n * @property {number[]|undefined} imageStrokeDash\n * @property {string|undefined} imageStrokeCap\n * @property {string|undefined} imageStrokeJoin\n * @property {IconOrigin|undefined} imageAnchorOrigin\n * @property {ColorLike|undefined} imageColor\n * @property {IconOrigin|undefined} imageOffsetOrigin\n * @property {Stroke|undefined} imageStroke\n * @property {Fill|undefined} imageFill\n * @property {string|undefined} imageCrossOrigin\n *\n * @property {Geometry|function|undefined} geom Coordinates should be in map projection\n */\n"],"names":["getStyleId","style","Vue","Style","ImageStyle","Text","Stroke","Fill","Function","id","Error","setStyleId","styleId","initializeStyle","defaultStyleId","uuid","defaultStyle","fillColor","strokeColor","strokeWidth","imageRadius","defaultEditStyle","styles","white","blue","width","GEOMETRY_TYPE","LINE_STRING","MULTI_LINE_STRING","POLYGON","MULTI_POLYGON","CIRCLE","POINT","zIndex","Infinity","MULTI_POINT","GEOMETRY_COLLECTION","isEmpty","x","length","createStyle","vlStyle","olStyle","text","createTextStyle","fill","createFillStyle","stroke","createStrokeStyle","image","createImageStyle","geometry","createGeomStyle","renderer","addPrefix","prefix","str","upperFirst","normalizeColor","color","c","parseColor","rgba","prefixKey","keys","compiledKey","fillStyle","reduce","value","name","lowerFirst","replace","RegExp","strokeStyle","imageSrc","imagePoints","isNumeric","imageStyle","Ctor","Icon","anchor","imageAnchor","anchorOrigin","imageAnchorOrigin","imageColor","offset","imageOffset","offsetOrigin","imageOffsetOrigin","opacity","imageOpacity","scale","imageScale","rotation","imageRotation","size","imageSize","img","imgSize","imageImgSize","src","crossOrigin","imageCrossOrigin","RegularShape","points","radius","radius1","imageRadius1","radius2","imageRadius2","angle","imageAngle","Circle","snapToPixel","textStyle","fontSize","textFontSize","isNumber","fontName","textFont","font","textFontWeight","join","pick","textScale","textRotation","offsetX","textOffsetX","offsetY","textOffsetY","rotateWithView","textRotateWithView","padding","textPadding","maxAngle","textMaxAngle","overflow","textOverflow","placement","textPlacement","backgroundFill","backgroundStroke","isFunction","geom","__styleGeomFunc","feature","geomHelper"],"mappings":"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"}