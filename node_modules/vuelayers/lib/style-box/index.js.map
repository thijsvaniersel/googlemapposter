{"version":3,"file":"index.js","sources":["src/component/style-box/style.vue?rollup-plugin-vue=script.js","src/component/style-box/style.vue","src/component/style-box/index.js"],"sourcesContent":["\nimport Style from 'ol/style/Style'\nimport Vue from 'vue'\nimport { style, withFillStrokeStyle } from '../../mixin'\nimport { isEqual } from '../../util/minilo'\nimport mergeDescriptors from '../../util/multi-merge-descriptors'\n\n/**\n * Style box component.\n * Wrapper for Style class. Can be inserted into component with setStyle/getStyle methods (vl-layer-vector, vl-feature & etc.)\n * and acts as a box for inner style components (vl-style-fill, vl-style-stroke, icon ...)\n */\n\nconst props = {\n  zIndex: {\n    type: Number,\n    default: 0,\n  },\n  condition: {\n    type: [Function, Boolean],\n    default: true,\n  },\n}\n\nconst methods = {\n  /**\n   * @return {Style}\n   * @protected\n   */\n  createStyle () {\n    return new Style({\n      zIndex: this.zIndex,\n      image: this._image,\n      stroke: this._stroke,\n      fill: this._fill,\n      text: this._text,\n      geometry: this._geometry,\n    })\n  },\n  /**\n   * @returns {Object}\n   * @protected\n   */\n  getServices () {\n    const vm = this\n\n    return mergeDescriptors(this::style.methods.getServices(), {\n      get stylesContainer () { return vm },\n    })\n  },\n  /**\n   * @return {void}\n   * @protected\n   */\n  mount () {\n    this.$stylesContainer && this.$stylesContainer.addStyle(this)\n  },\n  /**\n   * @return {void}\n   * @protected\n   */\n  unmount () {\n    this.$stylesContainer && this.$stylesContainer.removeStyle(this)\n  },\n  /**\n   * @param {Image|Vue|undefined} image\n   * @return {void}\n   */\n  setImage (image) {\n    image = image instanceof Vue ? image.$style : image\n\n    if (image !== this._image) {\n      this._image = image\n    }\n    if (this.$style && image !== this.$style.getImage()) {\n      this.$style.setImage(image)\n      this.scheduleRefresh()\n    }\n  },\n  /**\n   * @param {Geometry|Vue|undefined} geom\n   * @return {void}\n   */\n  setGeometry (geom) {\n    geom = geom instanceof Vue ? geom.$geometry : geom\n\n    if (geom !== this._geometry) {\n      this._geometry = geom\n    }\n    if (this.$style && geom !== this.$style.getGeometry()) {\n      this.$style.setGeometry(geom)\n      this.scheduleRefresh()\n    }\n  },\n  /**\n   * @param {Text|undefined} text\n   * @return {void}\n   */\n  setText (text) {\n    text = text instanceof Vue ? text.$style : text\n\n    if (text !== this._text) {\n      this._text = text\n    }\n    if (this.$style && text !== this.$style.getText()) {\n      this.$style.setText(text)\n      this.scheduleRefresh()\n    }\n  },\n}\n\nconst watch = {\n  zIndex (value) {\n    if (this.$style && !isEqual(value, this.$style.getZIndex())) {\n      this.$style.setZIndex(value)\n      this.scheduleRefresh()\n    }\n  },\n}\n\nexport default {\n  name: 'vl-style-box',\n  mixins: [style, withFillStrokeStyle],\n  props,\n  methods,\n  watch,\n}\n","<script>\n  import Style from 'ol/style/Style'\n  import Vue from 'vue'\n  import { style, withFillStrokeStyle } from '../../mixin'\n  import { isEqual } from '../../util/minilo'\n  import mergeDescriptors from '../../util/multi-merge-descriptors'\n\n  /**\n   * Style box component.\n   * Wrapper for Style class. Can be inserted into component with setStyle/getStyle methods (vl-layer-vector, vl-feature & etc.)\n   * and acts as a box for inner style components (vl-style-fill, vl-style-stroke, icon ...)\n   */\n\n  const props = {\n    zIndex: {\n      type: Number,\n      default: 0,\n    },\n    condition: {\n      type: [Function, Boolean],\n      default: true,\n    },\n  }\n\n  const methods = {\n    /**\n     * @return {Style}\n     * @protected\n     */\n    createStyle () {\n      return new Style({\n        zIndex: this.zIndex,\n        image: this._image,\n        stroke: this._stroke,\n        fill: this._fill,\n        text: this._text,\n        geometry: this._geometry,\n      })\n    },\n    /**\n     * @returns {Object}\n     * @protected\n     */\n    getServices () {\n      const vm = this\n\n      return mergeDescriptors(this::style.methods.getServices(), {\n        get stylesContainer () { return vm },\n      })\n    },\n    /**\n     * @return {void}\n     * @protected\n     */\n    mount () {\n      this.$stylesContainer && this.$stylesContainer.addStyle(this)\n    },\n    /**\n     * @return {void}\n     * @protected\n     */\n    unmount () {\n      this.$stylesContainer && this.$stylesContainer.removeStyle(this)\n    },\n    /**\n     * @param {Image|Vue|undefined} image\n     * @return {void}\n     */\n    setImage (image) {\n      image = image instanceof Vue ? image.$style : image\n\n      if (image !== this._image) {\n        this._image = image\n      }\n      if (this.$style && image !== this.$style.getImage()) {\n        this.$style.setImage(image)\n        this.scheduleRefresh()\n      }\n    },\n    /**\n     * @param {Geometry|Vue|undefined} geom\n     * @return {void}\n     */\n    setGeometry (geom) {\n      geom = geom instanceof Vue ? geom.$geometry : geom\n\n      if (geom !== this._geometry) {\n        this._geometry = geom\n      }\n      if (this.$style && geom !== this.$style.getGeometry()) {\n        this.$style.setGeometry(geom)\n        this.scheduleRefresh()\n      }\n    },\n    /**\n     * @param {Text|undefined} text\n     * @return {void}\n     */\n    setText (text) {\n      text = text instanceof Vue ? text.$style : text\n\n      if (text !== this._text) {\n        this._text = text\n      }\n      if (this.$style && text !== this.$style.getText()) {\n        this.$style.setText(text)\n        this.scheduleRefresh()\n      }\n    },\n  }\n\n  const watch = {\n    zIndex (value) {\n      if (this.$style && !isEqual(value, this.$style.getZIndex())) {\n        this.$style.setZIndex(value)\n        this.scheduleRefresh()\n      }\n    },\n  }\n\n  export default {\n    name: 'vl-style-box',\n    mixins: [style, withFillStrokeStyle],\n    props,\n    methods,\n    watch,\n  }\n</script>\n","import { pick } from '../../util/minilo'\nimport Style from './style.vue'\n\nfunction plugin (Vue, options = {}) {\n  if (plugin.installed) {\n    return\n  }\n  plugin.installed = true\n\n  options = pick(options, 'dataProjection')\n  Object.assign(Style, options)\n\n  Vue.component(Style.name, Style)\n}\n\nexport default plugin\n\nexport {\n  Style,\n  plugin as install,\n}\n"],"names":["props","zIndex","type","Number","default","condition","Function","Boolean","methods","createStyle","Style","image","_image","stroke","_stroke","fill","_fill","text","_text","geometry","_geometry","getServices","vm","mergeDescriptors","style","stylesContainer","mount","$stylesContainer","addStyle","unmount","removeStyle","setImage","Vue","$style","getImage","scheduleRefresh","setGeometry","geom","$geometry","getGeometry","setText","getText","watch","value","isEqual","getZIndex","setZIndex","name","mixins","withFillStrokeStyle","plugin","options","installed","pick","component"],"mappings":"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"}